{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst resize_observer_polyfill_1 = __importDefault(require(\"resize-observer-polyfill\"));\n\nconst React = __importStar(require(\"react\"));\n\nconst react_portal_1 = require(\"react-portal\");\n\nconst styled_components_1 = __importDefault(require(\"styled-components\"));\n\nconst SSR = typeof window === \"undefined\";\nconst defaultPosition = {\n  left: -1000,\n  top: 0,\n  offset: 0,\n  visible: false\n};\n\nconst useComponentSize = ref => {\n  const [size, setSize] = React.useState({\n    width: 0,\n    height: 0\n  });\n  React.useEffect(() => {\n    const sizeObserver = new resize_observer_polyfill_1.default(entries => {\n      entries.forEach(({\n        target\n      }) => {\n        if (size.width !== target.clientWidth || size.height !== target.clientHeight) {\n          setSize({\n            width: target.clientWidth,\n            height: target.clientHeight\n          });\n        }\n      });\n    });\n    sizeObserver.observe(ref.current);\n    return () => sizeObserver.disconnect();\n  }, [ref]);\n  return size;\n};\n\nfunction usePosition({\n  menuRef,\n  isSelectingText,\n  props\n}) {\n  const {\n    view,\n    active\n  } = props;\n  const {\n    selection\n  } = view.state;\n  const {\n    width: menuWidth,\n    height: menuHeight\n  } = useComponentSize(menuRef);\n\n  if (!active || !menuWidth || !menuHeight || SSR || isSelectingText) {\n    return defaultPosition;\n  }\n\n  let fromPos;\n  let toPos;\n\n  try {\n    fromPos = view.coordsAtPos(selection.from);\n    toPos = view.coordsAtPos(selection.to, -1);\n  } catch (err) {\n    console.warn(err);\n    return defaultPosition;\n  }\n\n  const selectionBounds = {\n    top: Math.min(fromPos.top, toPos.top),\n    bottom: Math.max(fromPos.bottom, toPos.bottom),\n    left: Math.min(fromPos.left, toPos.left),\n    right: Math.max(fromPos.right, toPos.right)\n  };\n  const isColSelection = selection.isColSelection && selection.isColSelection();\n  const isRowSelection = selection.isRowSelection && selection.isRowSelection();\n\n  if (isColSelection) {\n    const {\n      node: element\n    } = view.domAtPos(selection.from);\n    const {\n      width\n    } = element.getBoundingClientRect();\n    selectionBounds.top -= 20;\n    selectionBounds.right = selectionBounds.left + width;\n  }\n\n  if (isRowSelection) {\n    selectionBounds.right = selectionBounds.left = selectionBounds.left - 18;\n  }\n\n  const isImageSelection = selection.node && selection.node.type.name === \"image\";\n\n  if (isImageSelection) {\n    const element = view.nodeDOM(selection.from);\n    const imageElement = element.getElementsByTagName(\"img\")[0];\n    const {\n      left,\n      top,\n      width\n    } = imageElement.getBoundingClientRect();\n    return {\n      left: Math.round(left + width / 2 + window.scrollX - menuWidth / 2),\n      top: Math.round(top + window.scrollY - menuHeight),\n      offset: 0,\n      visible: true\n    };\n  } else {\n    const halfSelection = Math.abs(selectionBounds.right - selectionBounds.left) / 2;\n    const centerOfSelection = selectionBounds.left + halfSelection;\n    const margin = 12;\n    const left = Math.min(window.innerWidth - menuWidth - margin, Math.max(margin, centerOfSelection - menuWidth / 2));\n    const top = Math.min(window.innerHeight - menuHeight - margin, Math.max(margin, selectionBounds.top - menuHeight));\n    const offset = left - (centerOfSelection - menuWidth / 2);\n    return {\n      left: Math.round(left + window.scrollX),\n      top: Math.round(top + window.scrollY),\n      offset: Math.round(offset),\n      visible: true\n    };\n  }\n}\n\nfunction FloatingToolbar(props) {\n  const menuRef = props.forwardedRef || React.createRef();\n  const [isSelectingText, setSelectingText] = React.useState(false);\n  const position = usePosition({\n    menuRef,\n    isSelectingText,\n    props\n  });\n  React.useEffect(() => {\n    const handleMouseDown = () => {\n      if (!props.active) {\n        setSelectingText(true);\n      }\n    };\n\n    const handleMouseUp = () => {\n      setSelectingText(false);\n    };\n\n    window.addEventListener(\"mousedown\", handleMouseDown);\n    window.addEventListener(\"mouseup\", handleMouseUp);\n    return () => {\n      window.removeEventListener(\"mousedown\", handleMouseDown);\n      window.removeEventListener(\"mouseup\", handleMouseUp);\n    };\n  }, [props.active]);\n  return React.createElement(react_portal_1.Portal, null, React.createElement(Wrapper, {\n    active: props.active && position.visible,\n    ref: menuRef,\n    offset: position.offset,\n    style: {\n      top: `${position.top}px`,\n      left: `${position.left}px`\n    }\n  }, position.visible && props.children));\n}\n\nconst Wrapper = styled_components_1.default.div`\n  will-change: opacity, transform;\n  padding: 8px 16px;\n  position: absolute;\n  z-index: ${props => props.theme.zIndex + 100};\n  opacity: 0;\n  background-color: ${props => props.theme.toolbarBackground};\n  border-radius: 4px;\n  transform: scale(0.95);\n  transition: opacity 150ms cubic-bezier(0.175, 0.885, 0.32, 1.275),\n    transform 150ms cubic-bezier(0.175, 0.885, 0.32, 1.275);\n  transition-delay: 150ms;\n  line-height: 0;\n  height: 40px;\n  box-sizing: border-box;\n  pointer-events: none;\n  white-space: nowrap;\n\n  &::before {\n    content: \"\";\n    display: block;\n    width: 24px;\n    height: 24px;\n    transform: translateX(-50%) rotate(45deg);\n    background: ${props => props.theme.toolbarBackground};\n    border-radius: 3px;\n    z-index: -1;\n    position: absolute;\n    bottom: -2px;\n    left: calc(50% - ${props => props.offset || 0}px);\n  }\n\n  * {\n    box-sizing: border-box;\n  }\n\n  ${({\n  active\n}) => active && `\n    transform: translateY(-6px) scale(1);\n    pointer-events: all;\n    opacity: 1;\n  `};\n\n  @media print {\n    display: none;\n  }\n\n  @media (hover: none) and (pointer: coarse) {\n    &:before {\n      display: none;\n    }\n\n    transition: opacity 150ms cubic-bezier(0.175, 0.885, 0.32, 1.275);\n    transform: scale(1);\n    border-radius: 0;\n    position: fixed;\n    top: auto !important;\n    bottom: 0;\n    left: 0 !important;\n    right: 0 !important;\n  }\n`;\nexports.default = React.forwardRef(function FloatingToolbarWithForwardedRef(props, ref) {\n  return React.createElement(FloatingToolbar, Object.assign({}, props, {\n    forwardedRef: ref\n  }));\n});","map":{"version":3,"sources":["../../src/components/FloatingToolbar.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst resize_observer_polyfill_1 = __importDefault(require(\"resize-observer-polyfill\"));\nconst React = __importStar(require(\"react\"));\nconst react_portal_1 = require(\"react-portal\");\nconst styled_components_1 = __importDefault(require(\"styled-components\"));\nconst SSR = typeof window === \"undefined\";\nconst defaultPosition = {\n    left: -1000,\n    top: 0,\n    offset: 0,\n    visible: false,\n};\nconst useComponentSize = ref => {\n    const [size, setSize] = React.useState({\n        width: 0,\n        height: 0,\n    });\n    React.useEffect(() => {\n        const sizeObserver = new resize_observer_polyfill_1.default(entries => {\n            entries.forEach(({ target }) => {\n                if (size.width !== target.clientWidth ||\n                    size.height !== target.clientHeight) {\n                    setSize({ width: target.clientWidth, height: target.clientHeight });\n                }\n            });\n        });\n        sizeObserver.observe(ref.current);\n        return () => sizeObserver.disconnect();\n    }, [ref]);\n    return size;\n};\nfunction usePosition({ menuRef, isSelectingText, props }) {\n    const { view, active } = props;\n    const { selection } = view.state;\n    const { width: menuWidth, height: menuHeight } = useComponentSize(menuRef);\n    if (!active || !menuWidth || !menuHeight || SSR || isSelectingText) {\n        return defaultPosition;\n    }\n    let fromPos;\n    let toPos;\n    try {\n        fromPos = view.coordsAtPos(selection.from);\n        toPos = view.coordsAtPos(selection.to, -1);\n    }\n    catch (err) {\n        console.warn(err);\n        return defaultPosition;\n    }\n    const selectionBounds = {\n        top: Math.min(fromPos.top, toPos.top),\n        bottom: Math.max(fromPos.bottom, toPos.bottom),\n        left: Math.min(fromPos.left, toPos.left),\n        right: Math.max(fromPos.right, toPos.right),\n    };\n    const isColSelection = selection.isColSelection && selection.isColSelection();\n    const isRowSelection = selection.isRowSelection && selection.isRowSelection();\n    if (isColSelection) {\n        const { node: element } = view.domAtPos(selection.from);\n        const { width } = element.getBoundingClientRect();\n        selectionBounds.top -= 20;\n        selectionBounds.right = selectionBounds.left + width;\n    }\n    if (isRowSelection) {\n        selectionBounds.right = selectionBounds.left = selectionBounds.left - 18;\n    }\n    const isImageSelection = selection.node && selection.node.type.name === \"image\";\n    if (isImageSelection) {\n        const element = view.nodeDOM(selection.from);\n        const imageElement = element.getElementsByTagName(\"img\")[0];\n        const { left, top, width } = imageElement.getBoundingClientRect();\n        return {\n            left: Math.round(left + width / 2 + window.scrollX - menuWidth / 2),\n            top: Math.round(top + window.scrollY - menuHeight),\n            offset: 0,\n            visible: true,\n        };\n    }\n    else {\n        const halfSelection = Math.abs(selectionBounds.right - selectionBounds.left) / 2;\n        const centerOfSelection = selectionBounds.left + halfSelection;\n        const margin = 12;\n        const left = Math.min(window.innerWidth - menuWidth - margin, Math.max(margin, centerOfSelection - menuWidth / 2));\n        const top = Math.min(window.innerHeight - menuHeight - margin, Math.max(margin, selectionBounds.top - menuHeight));\n        const offset = left - (centerOfSelection - menuWidth / 2);\n        return {\n            left: Math.round(left + window.scrollX),\n            top: Math.round(top + window.scrollY),\n            offset: Math.round(offset),\n            visible: true,\n        };\n    }\n}\nfunction FloatingToolbar(props) {\n    const menuRef = props.forwardedRef || React.createRef();\n    const [isSelectingText, setSelectingText] = React.useState(false);\n    const position = usePosition({\n        menuRef,\n        isSelectingText,\n        props,\n    });\n    React.useEffect(() => {\n        const handleMouseDown = () => {\n            if (!props.active) {\n                setSelectingText(true);\n            }\n        };\n        const handleMouseUp = () => {\n            setSelectingText(false);\n        };\n        window.addEventListener(\"mousedown\", handleMouseDown);\n        window.addEventListener(\"mouseup\", handleMouseUp);\n        return () => {\n            window.removeEventListener(\"mousedown\", handleMouseDown);\n            window.removeEventListener(\"mouseup\", handleMouseUp);\n        };\n    }, [props.active]);\n    return (React.createElement(react_portal_1.Portal, null,\n        React.createElement(Wrapper, { active: props.active && position.visible, ref: menuRef, offset: position.offset, style: {\n                top: `${position.top}px`,\n                left: `${position.left}px`,\n            } }, position.visible && props.children)));\n}\nconst Wrapper = styled_components_1.default.div `\n  will-change: opacity, transform;\n  padding: 8px 16px;\n  position: absolute;\n  z-index: ${props => props.theme.zIndex + 100};\n  opacity: 0;\n  background-color: ${props => props.theme.toolbarBackground};\n  border-radius: 4px;\n  transform: scale(0.95);\n  transition: opacity 150ms cubic-bezier(0.175, 0.885, 0.32, 1.275),\n    transform 150ms cubic-bezier(0.175, 0.885, 0.32, 1.275);\n  transition-delay: 150ms;\n  line-height: 0;\n  height: 40px;\n  box-sizing: border-box;\n  pointer-events: none;\n  white-space: nowrap;\n\n  &::before {\n    content: \"\";\n    display: block;\n    width: 24px;\n    height: 24px;\n    transform: translateX(-50%) rotate(45deg);\n    background: ${props => props.theme.toolbarBackground};\n    border-radius: 3px;\n    z-index: -1;\n    position: absolute;\n    bottom: -2px;\n    left: calc(50% - ${props => props.offset || 0}px);\n  }\n\n  * {\n    box-sizing: border-box;\n  }\n\n  ${({ active }) => active &&\n    `\n    transform: translateY(-6px) scale(1);\n    pointer-events: all;\n    opacity: 1;\n  `};\n\n  @media print {\n    display: none;\n  }\n\n  @media (hover: none) and (pointer: coarse) {\n    &:before {\n      display: none;\n    }\n\n    transition: opacity 150ms cubic-bezier(0.175, 0.885, 0.32, 1.275);\n    transform: scale(1);\n    border-radius: 0;\n    position: fixed;\n    top: auto !important;\n    bottom: 0;\n    left: 0 !important;\n    right: 0 !important;\n  }\n`;\nexports.default = React.forwardRef(function FloatingToolbarWithForwardedRef(props, ref) {\n    return React.createElement(FloatingToolbar, Object.assign({}, props, { forwardedRef: ref }));\n});\n//# sourceMappingURL=FloatingToolbar.js.map"]},"metadata":{},"sourceType":"script"}